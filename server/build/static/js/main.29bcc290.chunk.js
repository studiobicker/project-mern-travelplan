(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{104:function(e,t,a){},105:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(32),c=a.n(s),i=a(14),l=(a(68),a(69),a(4)),o=a.n(l),u=a(10),m=a(5),p=a(6),d=a(8),h=a(7),v=a(9),f=a(31);function b(){return r.a.createElement("section",{className:"hero is-bg-img is-fullheight-with-navbar"},r.a.createElement("div",{className:"overlay"}),r.a.createElement("div",{className:"hero-body"},r.a.createElement("div",{className:"container has-text-centered"},r.a.createElement("div",{className:"columns is-centered"},r.a.createElement("div",{className:"column is-half"},r.a.createElement("h1",{className:"title is-2 has-text-white"},"WHERE ARE YOU OFF TO NEXT?"),r.a.createElement("h2",{className:"subtitle has-text-white"},"Plan your vacation with trip builder! Our travel planning tool helps you map out your ideal trip, organize all the details, and share them with your friends."))))))}var E=a(1),g=a(13),N=a(25),w=a.n(N),O=function e(){var t=this;Object(m.a)(this,e),this.login=function(){var e=Object(u.a)(o.a.mark((function e(a){var n,r,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.email,r=a.password,e.next=3,t.service.post("auth/login",{email:n,password:r});case 3:return s=e.sent,c=s.data,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.register=function(){var e=Object(u.a)(o.a.mark((function e(a){var n,r,s,c,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.name,r=a.email,s=a.password,e.next=3,t.service.post("auth/register",{name:n,email:r,password:s});case 3:return c=e.sent,i=c.data,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.isLoggedIn=Object(u.a)(o.a.mark((function e(){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.service.get("/auth/isLoggedIn");case 2:return a=e.sent,n=a.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)}))),this.logout=Object(u.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.service.get("/auth/logout");case 2:a=e.sent,a.data;case 4:case"end":return e.stop()}}),e)}))),this.service=w.a.create({baseURL:"https://tripbuilderapp.herokuapp.com/api",withCredentials:!0})};function j(e){var t=e.onSubmitHandler,a=e.onChangeHandler;return r.a.createElement("form",{onSubmit:t},r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label",htmlFor:"email"},"Email"),r.a.createElement("div",{className:"control has-icons-left has-icons-right"},r.a.createElement("input",{className:"input",type:"email",placeholder:"jane@example.com",name:"email",onChange:a,required:!0}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement("i",{className:"fas fa-user"})))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label",htmlFor:"password"},"Password"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"password",placeholder:"Password",name:"password",onChange:a,required:!0}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement("i",{className:"fas fa-lock"})))),r.a.createElement("div",{className:"field is-grouped is-grouped-right"},r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button  is-link"},"Log in"))))}function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function k(e){var t=e.setUserState,a=e.history,s=Object(n.useState)(null),c=Object(g.a)(s,2),i=c[0],l=c[1],m=Object(n.useState)({email:"",password:""}),p=Object(g.a)(m,2),d=p[0],h=p[1],v=new O,f=function(){var e=Object(u.a)(o.a.mark((function e(n){var r,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=2,e.next=5,v.login(d);case 5:r=e.sent,t(r),r.currentTrip?a.push("/trip/".concat(r.currentTrip.trip._id)):a.push("/dashboard"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),s=e.t0.response.data.message,l(s);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("section",{className:"section"},r.a.createElement("div",{className:"columns is-centered"},r.a.createElement("div",{className:"column is-one-third"},r.a.createElement("div",{className:"box"},r.a.createElement(j,{onSubmitHandler:f,onChangeHandler:function(e){var t=e.target,a=t.name,n=t.value;h(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){Object(E.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},d,Object(E.a)({},a,n)))}}),i&&r.a.createElement("code",{className:"is-error"},i))))))}function x(e){var t=e.onSubmitHandler,a=e.onChangeHandler;return r.a.createElement("form",{onSubmit:t},r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label",htmlFor:"name"},"Name"),r.a.createElement("div",{className:"control has-icons-left has-icons-right"},r.a.createElement("input",{className:"input",type:"text",placeholder:"Jane Smith",name:"name",onChange:a,required:!0}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement("i",{className:"fas fa-user"})))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label",htmlFor:"email"},"Email"),r.a.createElement("div",{className:"control has-icons-left "},r.a.createElement("input",{className:"input",type:"email",placeholder:"jane@example.com",name:"email",onChange:a,required:!0}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement("i",{className:"fas fa-envelope"})))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label",htmlFor:"password"},"Password"),r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"password",placeholder:"Password",name:"password",onChange:a,required:!0}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement("i",{className:"fas fa-lock"})))),r.a.createElement("div",{className:"field is-grouped is-grouped-right"},r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-link"},"Sign up"))))}function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function M(e){var t=e.setUserState,a=e.history,s=Object(n.useState)(null),c=Object(g.a)(s,2),i=c[0],l=c[1],m=Object(n.useState)({name:"",password:"",email:""}),p=Object(g.a)(m,2),d=p[0],h=p[1],v=new O,f=function(){var e=Object(u.a)(o.a.mark((function e(n){var r,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=2,e.next=5,v.register(d);case 5:r=e.sent,t(r),a.push("/dashboard"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),s=e.t0.response.data.message,l(s);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("section",{className:"section"},r.a.createElement("div",{className:"columns is-centered"},r.a.createElement("div",{className:"column is-one-third"},r.a.createElement("div",{className:"box"},r.a.createElement(x,{onSubmitHandler:f,onChangeHandler:function(e){e.preventDefault();var t=e.target,a=t.name,n=t.value;h(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){Object(E.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},d,Object(E.a)({},a,n)))}}),i&&r.a.createElement("code",{className:"is-error"},i)))))}var C=function e(){var t=this;Object(m.a)(this,e),this.getMyTrips=Object(u.a)(o.a.mark((function e(){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.service.get("/trip/getTripsByUser");case 2:return a=e.sent,n=a.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)}))),this.create=function(){var e=Object(u.a)(o.a.mark((function e(a){var n,r,s,c,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.name,r=a.description,s=a.selectedLatLng,e.next=3,t.service.post("trip/createTrip",{name:n,description:r,country:s.label,latitude:s.value[0],longitude:s.value[1]});case 3:return c=e.sent,i=c.data,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.setCurrentTrip=function(){var e=Object(u.a)(o.a.mark((function e(a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,t.service.get("trip/setCurrentTrip/".concat(a));case 3:return n=e.sent,r=n.data,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getTripById=function(){var e=Object(u.a)(o.a.mark((function e(a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.service.get("trip/getTripById/".concat(a));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getTripDestinations=function(){var e=Object(u.a)(o.a.mark((function e(a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.service.get("trip/getTripDestinations/".concat(a));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getTripMembers=function(){var e=Object(u.a)(o.a.mark((function e(a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.service.get("trip/getTripMembers/".concat(a));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getTripMessages=function(){var e=Object(u.a)(o.a.mark((function e(a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.service.get("trip/getTripMessages/".concat(a));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getInvitations=function(){var e=Object(u.a)(o.a.mark((function e(a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.service.get("trip/invitation/getTripInvitations/".concat(a));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.sendInvitation=function(){var e=Object(u.a)(o.a.mark((function e(a,n){var r,s,c,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.email,s=a.level,e.next=3,t.service.post("trip/invitation/send/".concat(n),{email:r,level:parseInt(s)});case 3:return c=e.sent,i=c.data,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.deleteInvitation=function(){var e=Object(u.a)(o.a.mark((function e(a,n){var r,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a,e.next=3,t.service.post("trip/invitation/remove/".concat(n),{invitationId:r});case 3:return s=e.sent,c=s.data,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.getInvitation=function(){var e=Object(u.a)(o.a.mark((function e(a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.service.get("public/getInvitation/".concat(a));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.acceptInvitation=function(){var e=Object(u.a)(o.a.mark((function e(a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.service.get("trip/invitation/accept/".concat(a));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.compareEmail=function(){var e=Object(u.a)(o.a.mark((function e(a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.service.get("trip/invitation/compare/".concat(a));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.addDestination=function(){var e=Object(u.a)(o.a.mark((function e(a,n){var r,s,c,i,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.name,s=a.latitude,c=a.longitude,e.next=3,t.service.post("trip/destination/add/".concat(n),{name:r,latitude:s,longitude:c});case 3:return i=e.sent,l=i.data,e.abrupt("return",l);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.deleteDestination=function(){var e=Object(u.a)(o.a.mark((function e(a,n){var r,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a,e.next=3,t.service.post("trip/destination/remove/".concat(n),{destinationId:r});case 3:return s=e.sent,c=s.data,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.changeOrderDestination=function(){var e=Object(u.a)(o.a.mark((function e(a,n){var r,s,c,i,l,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.destId,s=a.secondDestSeq,c=a.secondDestId,i=a.destSeq,e.next=4,t.service.post("trip/destination/change/".concat(n),{destId:r,secondDestSeq:s,secondDestId:c,destSeq:i});case 4:return l=e.sent,u=l.data,e.abrupt("return",u);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.addMessage=function(){var e=Object(u.a)(o.a.mark((function e(a,n){var r,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a,e.next=4,t.service.post("trip/message/add/".concat(n),{msg:r});case 4:return s=e.sent,c=s.data,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.deleteMessage=function(){var e=Object(u.a)(o.a.mark((function e(a,n){var r,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a,e.next=3,t.service.post("trip/message/remove/".concat(n),{messageId:r});case 3:return s=e.sent,c=s.data,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.service=w.a.create({baseURL:"https://tripbuilderapp.herokuapp.com/api",withCredentials:!0})};function T(e){return r.a.createElement("div",{className:"box"},r.a.createElement("article",{className:"media"},r.a.createElement("div",{className:"media-left"},r.a.createElement("figure",{className:"image is-128x128"},r.a.createElement("img",{src:e.trip.tripPicture,alt:e.trip.name}))),r.a.createElement("div",{className:"media-content"},r.a.createElement("div",{className:"content"},r.a.createElement("p",null,r.a.createElement("strong",null,e.trip.name),r.a.createElement("br",null),e.trip.description),r.a.createElement("p",null)),r.a.createElement("div",{className:"field is-grouped is-grouped-right"},r.a.createElement(i.b,{className:"button is-success",to:"/travelplan/".concat(e.trip._id)},r.a.createElement("span",{className:"icon is-small"},r.a.createElement("i",{className:"fas fa-map-marked-alt"})),r.a.createElement("span",null,"Go to Travel Plan"))))))}function D(){return r.a.createElement("div",{class:"content has-text-centered"},r.a.createElement("h2",{className:"Subtitle"},"No trips found"),r.a.createElement("p",null,"Ready to create your first trip?"),r.a.createElement(i.b,{className:"button is-success",to:"/add-trip"},"Add a trip"))}function I(e){e.className;return r.a.createElement("section",{className:"hero is-fullheight-with-navbar"},r.a.createElement("div",{className:"hero-body loader-container"},r.a.createElement("div",{className:"loader"})))}var L=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).componentDidMount=Object(u.a)(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.tripService.getMyTrips();case 3:a=t.sent,e.setState({myTrips:a,isLoading:!1}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])}))),e.renderTrips=function(){return e.state.myTrips&&e.state.myTrips.length>0?e.state.myTrips.map((function(e,t){return r.a.createElement(T,Object.assign({key:t},e))})):r.a.createElement(D,null)},e.state={myTrips:null,isLoading:!0},e.tripService=new C,e}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return this.state.isLoading?r.a.createElement(I,{className:"full-screen-loader"}):r.a.createElement("section",{className:"section"},r.a.createElement("div",{className:"container"},this.renderTrips()))}}]),t}(n.Component),P=function e(){var t=this;Object(m.a)(this,e),this.uploadProfile=function(){var e=Object(u.a)(o.a.mark((function e(a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,t.service.post("/upload/profilePicture",a);case 3:return n=e.sent,r=n.data,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.service=w.a.create({baseURL:"https://tripbuilderapp.herokuapp.com/api",withCredentials:!0})};function H(e){var t=e.user,a=e.setUserState,s=new P,c=Object(n.createRef)(),i=Object(n.useState)(null),l=Object(g.a)(i,2),m=l[0],p=l[1],d=function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,n=new FormData(c.current),e.next=6,s.uploadProfile(n);case 6:r=e.sent,a(r),p(null),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(1),i=e.t0.response.data.message,p(i);case 16:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("section",{className:"section"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"columns is-centered"},r.a.createElement("div",{className:"column is-two-thirds"},r.a.createElement("div",{className:"box"},t.profilePicture&&r.a.createElement("figure",{className:"image is-128x128"},r.a.createElement("img",{className:"is-rounded",src:t.profilePicture})),r.a.createElement("form",{onSubmit:d,ref:c,encType:"multipart/form-data"},r.a.createElement("input",{type:"file",name:"picture",placeholder:"upload your profile"}),r.a.createElement("button",{type:"submit"},"Upload photo"),m&&r.a.createElement("p",null,m)))))))}var U=function e(){var t=this;Object(m.a)(this,e),this.getAll=Object(u.a)(o.a.mark((function e(){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.service.get("all");case 2:return a=e.sent,n=a.data,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)}))),this.service=w.a.create({baseURL:"https://restcountries.eu/rest/v2/"})},A=a(62),_=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).componentDidMount=Object(u.a)(o.a.mark((function t(){var a,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.countryService.getAll();case 3:a=t.sent,n=a.map((function(e){return{value:e.latlng,label:e.name}})),e.setState({countries:n,isLoading:!1}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])}))),e.handleSelectChange=function(t){e.setState({selectedLatLng:t})},e.onChangeHandler=function(t){var a=t.target,n=a.name,r=a.value;e.setState(Object(E.a)({},n,r))},e.onSubmitHandler=function(){var t=Object(u.a)(o.a.mark((function t(a){var n,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=2,t.next=5,e.tripService.create(e.state);case 5:n=t.sent,e.props.setUserState(n),e.props.history.push("/trip/".concat(n.currentTrip.trip._id)),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(2),r=t.t0.response.data.message,e.setState({err:r});case 15:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}(),e.state={name:"",description:"",selectedLatLng:null,countries:null,err:null,isLoading:!0},e.tripService=new C,e.countryService=new U,e}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.state,t=e.selectedLatLng,a=e.countries;return this.state.isLoading?r.a.createElement(I,{className:"full-screen-loader"}):r.a.createElement("section",{className:"section"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"content has-text-centered"},r.a.createElement("h2",{className:"Subtitle"},"New Trip")),r.a.createElement("div",{className:"columns is-centered"},r.a.createElement("div",{className:"column is-half"},r.a.createElement("form",{onSubmit:this.onSubmitHandler},r.a.createElement("div",{className:"box"},r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label",htmlFor:"name"},"What's the name of your trip"),r.a.createElement("div",{className:"control"},r.a.createElement("input",{className:"input",type:"text",placeholder:"Name of your trip",name:"name",onChange:this.onChangeHandler,required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label",htmlFor:"name"},"Which country do you want to visit?"),r.a.createElement(A.a,{value:t,onChange:this.handleSelectChange,options:a}),r.a.createElement("p",{className:"help"},"If you plan to visit multiple countries, just fill in the first one. Don't worry, you can change this later.")),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label",htmlFor:"description"},"A few words about your trip"),r.a.createElement("div",{className:"control"},r.a.createElement("textarea",{className:"textarea",placeholder:"Description",name:"description",onChange:this.onChangeHandler}))),r.a.createElement("div",{className:"field is-grouped is-grouped-right"},r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-link"},"Create trip")))),this.state.err&&r.a.createElement("code",{className:"is-error"},this.state.err))))))}}]),t}(n.Component),R=function e(){var t=this;Object(m.a)(this,e),this.getWeather=function(){var e=Object(u.a)(o.a.mark((function e(a,n){var r,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"66578334c5710fdd247d39820c38a8fe",e.next=4,t.service.get("weather?lat=".concat(a,"&lon=").concat(n,"&units=metric&APPID=").concat("66578334c5710fdd247d39820c38a8fe"));case 4:return r=e.sent,s=r.data,e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.service=w.a.create({baseURL:"https://api.openweathermap.org/data/2.5/"})},q=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).componentDidMount=Object(u.a)(o.a.mark((function t(){var a,n,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.match.params.id,t.prev=1,t.next=5,e.tripService.getTripById(a);case 5:return n=t.sent,t.next=8,e.weatherService.getWeather(n.trip.country.latitude,n.trip.country.longitude);case 8:r=t.sent,e.setState({trip:n.trip,level:n.level,weather:r,isLoadingTrip:!1}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(1),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[1,13]])}))),e.state={trip:null,level:null,weather:null,isLoadingTrip:!0,err:null},e.tripService=new C,e.weatherService=new R,e}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return this.state.isLoadingTrip?r.a.createElement(I,{className:"full-screen-loader"}):r.a.createElement("section",{className:"section"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"tile is-ancestor"},r.a.createElement("div",{className:"tile is-vertical is-8"},r.a.createElement("div",{className:"tile is-parent"},r.a.createElement("article",{className:"tile is-child content notification is-link"},r.a.createElement("h2",{className:"title"},this.state.trip.name),r.a.createElement("div",{className:"tile-menu"},r.a.createElement("i",{className:"fas fa-ellipsis-v"})),r.a.createElement("div",{className:"subtitle"},this.state.trip.country.name),r.a.createElement("p",null,this.state.trip.description),r.a.createElement("div",{className:"currentWeather"},r.a.createElement("div",{className:"weatherIcon i-".concat(this.state.weather.weather[0].icon)}),r.a.createElement("div",{className:"temp"},this.state.weather.main.temp,"\xb0"),r.a.createElement("div",{className:"desc"},this.state.weather.weather[0].description)))),r.a.createElement("div",{className:"tile"},r.a.createElement("div",{className:"tile is-parent is-vertical"},r.a.createElement("article",{className:"tile is-child box"}),r.a.createElement("article",{className:"tile is-child box"})),r.a.createElement("div",{className:"tile is-parent"},r.a.createElement("article",{className:"tile is-child box"})))),r.a.createElement("div",{className:"tile is-parent"},r.a.createElement("article",{className:"tile is-child content box"},r.a.createElement("h3",{className:"subtitle"},"Members"))))))}}]),t}(n.Component),F=a(16);function V(e){var t=e.index,a=e.destination,n=e.deleteDestination,s=e.changeOrderDestination;Object(F.a)(e,["index","destination","deleteDestination","changeOrderDestination"]);return r.a.createElement("li",null,r.a.createElement("div",{className:"destLi"},r.a.createElement("i",{className:"fas fa-caret-up",onClick:function(){return s("up",t)}}),r.a.createElement("i",{className:"fas fa-caret-down",onClick:function(){return s("down",t)}}),r.a.createElement("span",null,a.name),r.a.createElement("span",{className:"is-pulled-right",onClick:function(){return n(a._id)}},r.a.createElement("i",{className:"fas fa-trash-alt"}))))}a(91),a(92);var B=a(30);var W=a(29),z=a(59),Y=a(43);function G(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function J(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?G(Object(a),!0).forEach((function(t){Object(E.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):G(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Q="pk.eyJ1Ijoic3R1ZGlvYmlja2VyIiwiYSI6ImNrM2c2dDNhaDBiZjYzb3Fub2cwMjh4aHQifQ.hLzsePe3Y1EHgyQPg6hYVA",Z={id:"route",type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#888","line-width":2,"line-dasharray":[1,2]}},X=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).componentDidMount=Object(u.a)(o.a.mark((function t(){var a,n,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.match.params.id,t.prev=1,t.next=4,e.tripService.getTripDestinations(a);case 4:n=t.sent,r=e.setViewport(n.trip),e.setState({trip:n.trip,userLevel:n.level,viewport:r,isLoadingTrip:!1}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])}))),e.setViewport=function(t){var a=[],n=[];t.destinations.map((function(e,t){a[t]=parseFloat(e.longitude),n[t]=parseFloat(e.latitude)}));var r,s=function(e,t){console.log(e);var a=Math.min.apply(Math,Object(B.a)(e)),n=Math.max.apply(Math,Object(B.a)(e));return[[a,Math.min.apply(Math,Object(B.a)(t))],[n,Math.max.apply(Math,Object(B.a)(t))]]}(a,n);if(t.destinations.length>0){var c=new Y.a(e.state.viewport).fitBounds(s,{padding:100}),i=c.longitude,l=c.latitude,o=c.zoom;r=J({},e.state.viewport,{width:"100%",height:"80vh",longitude:i,latitude:l,zoom:o,transitionDuration:1e3,transitionInterpolator:new W.a})}else r=J({},e.state.viewport,{longitude:t.country.longitude,latitude:t.country.latitude,width:"100%",height:"80vh",transitionDuration:1e3,transitionInterpolator:new W.a});return r},e.listOfMarkers=function(){return e.state.trip.destinations.map((function(e,t){return r.a.createElement(W.c,{key:t,latitude:e.latitude,longitude:e.longitude,offsetLeft:-20,offsetTop:-10},r.a.createElement("span",{className:"tag is-primary"},e.name))}))},e.listOfDestinations=function(){return e.state.trip.destinations.map((function(t,a){return r.a.createElement(V,{key:a,index:a,destination:t,deleteDestination:e.deleteDestination,changeOrderDestination:e.changeOrderDestination},r.a.createElement("span",{className:"tag is-primary"},t.name))}))},e.drawRoute=function(){var t=[];return e.state.trip.destinations.map((function(e,a){t[a]=[e.longitude,e.latitude]})),{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"LineString",coordinates:t}}]}},e.addDestination=function(){var t=Object(u.a)(o.a.mark((function t(a){var n,r,s,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=e.state.trip._id,t.next=4,e.tripService.addDestination(a,n);case 4:r=t.sent,s=e.setViewport(r),e.setState({trip:r,viewport:s}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),c=t.t0.response.data.message,e.setState({err:c});case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}(),e.deleteDestination=function(){var t=Object(u.a)(o.a.mark((function t(a){var n,r,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.trip._id,t.next=3,e.tripService.deleteDestination(a,n);case 3:r=t.sent,s=e.setViewport(r),e.setState({trip:r,viewport:s});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.changeOrderDestination=function(){var t=Object(u.a)(o.a.mark((function t(a,n){var r,s,c,i,l,u,m,p,d,h;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.state.trip._id,s=e.state.trip.destinations,c=s[n]._id,i=s[n].sequence,"up"!==a||!s[n-1]){t.next=13;break}return l=s[n-1]._id,u=s[n-1].sequence,t.next=9,e.tripService.changeOrderDestination({destId:c,secondDestSeq:u,secondDestId:l,destSeq:i},r);case 9:m=t.sent,e.setState({trip:m}),t.next=20;break;case 13:if("down"!==a||!s[n+1]){t.next=20;break}return p=s[n+1]._id,d=s[n+1].sequence,t.next=18,e.tripService.changeOrderDestination({destId:c,secondDestSeq:d,secondDestId:p,destSeq:i},r);case 18:h=t.sent,e.setState({trip:h});case 20:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.handleViewportChange=function(t){e.setState({viewport:J({},e.state.viewport,{},t)})},e.handleGeocoderViewportChange=function(t){return e.handleViewportChange(J({},t,{},{transitionDuration:1e3}))},e.handleGeoResult=function(t){var a={};a.name=t.result.text,a.longitude=t.result.geometry.coordinates[0],a.latitude=t.result.geometry.coordinates[1],e.addDestination(a)},e.state={trip:null,userLevel:null,isLoadingTrip:!0,viewport:{width:400,height:400,longitude:4.89066,latitude:52.373169,zoom:3},mapStyle:"mapbox://styles/studiobicker/ck3jwdm2s18n71dmzr1z32dks",err:null},e.tripService=new C,e.mapRef=r.a.createRef(),e}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return this.state.isLoadingTrip?r.a.createElement(I,{className:"full-screen-loader"}):r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"tile is-ancestor"},r.a.createElement("div",{className:"tile is-parent is-8"},r.a.createElement("article",{className:"tile is-child"},r.a.createElement("figure",{className:"image"},r.a.createElement(W.e,Object.assign({ref:this.mapRef},this.state.viewport,{mapStyle:this.state.mapStyle,onViewportChange:this.handleViewportChange,mapboxApiAccessToken:Q}),this.listOfMarkers(),r.a.createElement(W.d,{type:"geojson",data:this.drawRoute()},r.a.createElement(W.b,Z))),r.a.createElement(z.a,Object(E.a)({mapRef:this.mapRef,mapboxApiAccessToken:Q,onResult:this.handleGeoResult},"mapboxApiAccessToken",Q))))),r.a.createElement("div",{className:"tile is-parent"},r.a.createElement("article",{className:"tile is-child content box"},r.a.createElement("h3",{className:"subtitle"},"Add a destination"),r.a.createElement("p",{className:"is-size-7"},r.a.createElement("i",{className:"far fa-lightbulb"})," Use the search field on the map canvas"),r.a.createElement("br",null),r.a.createElement("ul",null,this.listOfDestinations()))))))}}]),t}(n.Component);function $(e){var t=e.tripId;Object(F.a)(e,["tripId"]);return r.a.createElement("aside",{className:"menu"},r.a.createElement("p",{className:"menu-label"},"Activity"),r.a.createElement("ul",{className:"menu-list"},r.a.createElement("li",null,r.a.createElement(i.b,{to:"/travelplan/".concat(t)},"Travel Plan")),r.a.createElement("li",null,r.a.createElement(i.b,{to:"/tripmembers/".concat(t)},"Trip Members")),r.a.createElement("li",null,r.a.createElement(i.b,{to:"/messages/".concat(t)},"Messages"))))}function K(e){e.index;var t=e.member;e.deleteMember,Object(F.a)(e,["index","member","deleteMember"]);return r.a.createElement("li",null,r.a.createElement("button",{className:"button is-medium is-white is-image","data-tooltip":t.user.name},r.a.createElement("figure",{className:"image is-48x48"},r.a.createElement("img",{className:"is-rounded",src:t.user.profilePicture}))))}var ee=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).onChangeHandler=function(t){var a=t.target,n=a.name,r=a.value;e.setState(Object(E.a)({},n,r))},e.onSubmitHandler=function(){var t=Object(u.a)(o.a.mark((function t(a){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault(),e.props.sendInvitation(e.state);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.state={email:"",level:10},e}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"modal is-active"},r.a.createElement("div",{className:"modal-background",onClick:this.props.toggleModal}),r.a.createElement("div",{className:"modal-card"},r.a.createElement("form",{onSubmit:this.onSubmitHandler},r.a.createElement("header",{className:"modal-card-head"},r.a.createElement("p",{className:"modal-card-title"},"Send an invitation")),r.a.createElement("section",{className:"modal-card-body"},r.a.createElement("div",{className:"field"},r.a.createElement("label",{class:"label"},"Who would you like to invite?"),r.a.createElement("p",{className:"control"},r.a.createElement("input",{className:"input",name:"email",onChange:this.onChangeHandler,value:this.state.email,type:"email",placeholder:"Enter a email address",required:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"What can they do?"),r.a.createElement("p",{className:"control"},r.a.createElement("label",{className:"radio"},r.a.createElement("input",{value:"5",type:"radio",name:"level",onChange:this.onChangeHandler,checked:5==this.state.level})," ","Edit the travel plan, invite others and comment it"),r.a.createElement("br",null),r.a.createElement("label",{className:"radio"},r.a.createElement("input",{value:"10",type:"radio",name:"level",onChange:this.onChangeHandler,checked:10==this.state.level})," ","View the travel plan and comment it")))),r.a.createElement("footer",{className:"modal-card-foot"},r.a.createElement("button",{className:"button",onClick:this.props.toggleModal},"Cancel"),r.a.createElement("button",{className:"button is-link"},"Send")))))}}]),t}(n.Component),te=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).componentDidMount=Object(u.a)(o.a.mark((function t(){var a,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.match.params.id,t.prev=1,t.next=4,e.tripService.getTripMembers(a);case 4:n=t.sent,e.setState({trip:n.trip,level:n.level,isLoadingTrip:!1}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])}))),e.toggleModal=function(){e.setState({showModal:!e.state.showModal})},e.listOfMembers=function(){return e.state.trip.members.map((function(t,a){return r.a.createElement(K,{key:a,index:a,member:t,deleteMember:e.deleteMember})}))},e.sendInvitation=function(){var t=Object(u.a)(o.a.mark((function t(a){var n,r,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=e.props.match.params.id,t.next=4,e.tripService.sendInvitation(a,n);case 4:r=t.sent,e.setState({showModal:!1,msg:r.message}),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),s=t.t0.response.data.message,e.setState({err:s,showModal:!1});case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}(),e.state={trip:null,level:null,isLoadingTrip:!0,err:null,msg:null,showModal:!1},e.tripService=new C,e}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return this.state.isLoadingTrip?r.a.createElement(I,{className:"full-screen-loader"}):r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"db-duo"},r.a.createElement("aside",{className:"db-side"},r.a.createElement($,{tripId:this.state.trip._id})),r.a.createElement("div",{className:"db-lead"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-content"},r.a.createElement("h2",{className:"subtitle"},"Members"),r.a.createElement("ul",{className:"memberList"},this.listOfMembers(),this.state.level.levelnum<=5&&r.a.createElement("li",null,r.a.createElement("button",{onClick:this.toggleModal,className:"button is-medium is-light is-round"},r.a.createElement("span",{className:"icon"},r.a.createElement("i",{className:"fas fa-plus"}))))),this.state.showModal&&r.a.createElement(ee,{toggleModal:this.toggleModal,sendInvitation:this.sendInvitation})),this.state.err&&r.a.createElement("article",{class:"message is-error"},r.a.createElement("div",{class:"message-body"},this.state.err)),this.state.msg&&r.a.createElement("article",{class:"message is-success"},r.a.createElement("div",{class:"message-body"},this.state.msg))))))}}]),t}(n.Component),ae=a(61),ne=a.n(ae);function re(e){var t=e.trip,a=e.acceptInvitation,n=e.match;return r.a.createElement("section",{className:"section"},r.a.createElement("div",{className:"columns is-centered"},r.a.createElement("div",{className:"column is-one-third"},r.a.createElement("div",{className:"box"},r.a.createElement("div",{className:"content"},r.a.createElement("h2",{className:"subtitle"},"You're invited for trip ",t),r.a.createElement("p",null,"By accepting this invitation you will be able to view, build, and discuss this trip with all other trip members."),!n&&r.a.createElement("p",null,r.a.createElement("em",null,"The email address of the logged in user doesn't match with the email address on the invitation. Are you sure you want to continue?"))),r.a.createElement("div",{className:"field is-grouped"},r.a.createElement("p",{className:"control"},r.a.createElement(i.b,{className:"button",to:"/dashboard"},"Cancel")),r.a.createElement("p",{className:"control"},r.a.createElement("button",{className:"button is-link",onClick:a},"Accept")))))))}var se=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).onChangeHandler=function(t){var a=t.target,n=a.name,r=a.value;e.setState(Object(E.a)({},n,r))},e.onSubmitHandler=function(){var t=Object(u.a)(o.a.mark((function t(a){var n,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=2,t.next=5,e.authService.login({email:e.state.email,password:e.state.password});case 5:n=t.sent,e.props.acceptInvitation(),e.props.setUserState(n),e.props.history.push("/dashboard"),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(2),r=t.t0.response.data.message,e.setState({err:r});case 18:case"end":return t.stop()}}),t,null,[[2,14]])})));return function(e){return t.apply(this,arguments)}}(),e.state={err:null,email:"",password:""},e.authService=new O,e}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("section",{className:"section"},r.a.createElement("div",{className:"columns is-centered"},r.a.createElement("div",{className:"column is-one-third"},r.a.createElement("div",{className:"box"},r.a.createElement("div",{className:"content"},r.a.createElement("h2",{className:"subtitle"},"You're invited for trip ",this.props.trip),r.a.createElement("p",null,"Sign in to Trip Builder and join trip ",this.props.trip,". Or"," ",r.a.createElement(i.b,{to:"/invite/register?token=".concat(this.props.token),onClick:function(){return e.props.setTaskState("register")}},r.a.createElement("strong",null,"sign up"))," ","if you don't have an account."),r.a.createElement(j,{onSubmitHandler:this.onSubmitHandler,onChangeHandler:this.onChangeHandler}),this.state.err&&r.a.createElement("code",{className:"is-error"},this.state.err))))))}}]),t}(n.Component),ce=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).onChangeHandler=function(t){var a=t.target,n=a.name,r=a.value;e.setState(Object(E.a)({},n,r))},e.onSubmitHandler=function(){var t=Object(u.a)(o.a.mark((function t(a){var n,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=2,t.next=5,e.authService.register({name:e.state.name,email:e.state.email,password:e.state.password});case 5:n=t.sent,e.props.acceptInvitation(),e.props.setUserState(n),e.props.history.push("/dashboard"),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(2),r=t.t0.response.data.message,e.setState({err:r});case 15:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}(),e.state={err:null,name:"",email:"",password:""},e.authService=new O,e}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("section",{className:"section"},r.a.createElement("div",{className:"columns is-centered"},r.a.createElement("div",{className:"column is-one-third"},r.a.createElement("div",{className:"box"},r.a.createElement("div",{className:"content"},r.a.createElement("h2",{className:"subtitle"},"You're invited for trip ",this.props.trip),r.a.createElement("p",null,"Sign up for a free Trip Builder account and join trip"," ",this.props.trip,". Or"," ",r.a.createElement(i.b,{to:"/invite/accept?token=".concat(this.props.token),onClick:function(){return e.props.setTaskState("accept")}},r.a.createElement("strong",null,"sign in"))," ","if you already have an account. Sign in to Or if you don't have an account."),r.a.createElement(x,{onSubmitHandler:this.onSubmitHandler,onChangeHandler:this.onChangeHandler}),this.state.err&&r.a.createElement("code",{className:"is-error"},this.state.err))))))}}]),t}(n.Component);function ie(e){var t=e.message;return r.a.createElement("section",{className:"hero is-fullheight-with-navbar"},r.a.createElement("div",{className:"hero-body loader-container"},r.a.createElement("div",{className:"content"},r.a.createElement("h2",{className:"Subtitle"},"Something went wrong"),r.a.createElement("p",null,t))))}var le=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).componentDidMount=Object(u.a)(o.a.mark((function t(){var a,n,r,s,c,i,l,u;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.match.params.task,n=ne.a.parse(e.props.location.search).token,s=null,t.prev=3,t.next=6,e.tripService.getInvitation(n);case 6:if(r=t.sent,c=e.props.user,i=null,!c){t.next=14;break}return t.next=12,e.tripService.compareEmail(r._id);case 12:l=t.sent,i=l.result;case 14:e.setState({task:a,invitation:r,match:i,user:c,err:s,isLoading:!1}),t.next=22;break;case 18:t.prev=18,t.t0=t.catch(3),u=t.t0.response.data.message,e.setState({err:u,isLoading:!1});case 22:case"end":return t.stop()}}),t,null,[[3,18]])}))),e.setTaskState=function(t){e.setState({task:t})},e.acceptInvitation=Object(u.a)(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=1,t.next=4,e.tripService.acceptInvitation(e.state.invitation.uuid);case 4:t.sent,e.props.history.push("/dashboard"),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),a=t.t0.response.data.message,e.setState({err:a});case 12:case"end":return t.stop()}}),t,null,[[1,8]])}))),e.state={task:null,invitation:null,match:null,isLoading:!0,user:null,err:null},e.tripService=new C,e}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return this.state.isLoading?r.a.createElement(I,{className:"full-screen-loader"}):this.state.err?r.a.createElement(ie,{message:this.state.err}):this.state.user?r.a.createElement(re,{trip:this.state.invitation.trip.name,acceptInvitation:this.acceptInvitation,match:this.match}):"accept"===this.state.task?r.a.createElement(se,{trip:this.state.invitation.trip.name,token:this.state.invitation.uuid,acceptInvitation:this.acceptInvitation,setTaskState:this.setTaskState,setUserState:this.props.setUserState,history:this.props.history}):r.a.createElement(ce,{trip:this.state.invitation.trip.name,token:this.state.invitation.uuid,acceptInvitation:this.acceptInvitation,setTaskState:this.setTaskState,setUserState:this.props.setUserState,history:this.props.history})}}]),t}(n.Component);function oe(e){var t=e.message,a=e.user;return r.a.createElement("li",{className:"message ".concat(a===t.user?"right":"left")},t.msg)}function ue(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function me(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(a),!0).forEach((function(t){Object(E.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ue(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var pe=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).componentDidMount=Object(u.a)(o.a.mark((function t(){var a,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.match.params.id,t.prev=2,t.next=5,e.tripService.getTripMessages(a);case 5:n=t.sent,e.setState({trip:n.trip,userLevel:n.level,isLoadingTrip:!1}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[2,9]])}))),e.listOfMessages=function(){return e.state.trip.messageboard.map((function(t,a){return r.a.createElement(oe,{key:a,message:t,user:e.props.user})}))},e.addMessage=function(){var t=Object(u.a)(o.a.mark((function t(a){var n,r,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=e.state.trip._id,t.next=5,e.tripService.addMessage(a,n);case 5:r=t.sent,e.setState({trip:me({},e.state.trip,{messageboard:e.state.trip.messageboard.concat(r)}),msg:""}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),s=t.t0.response.data.message,e.setState({err:s});case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}(),e.deleteMessage=function(){var t=Object(u.a)(o.a.mark((function t(a){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.trip._id,t.next=3,e.tripService.deleteMessage(a,n);case 3:t.sent;case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onChangeHandler=function(t){var a=t.target,n=a.name,r=a.value;e.setState(Object(E.a)({},n,r))},e.onSubmitHandler=function(){var t=Object(u.a)(o.a.mark((function t(a){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault(),e.addMessage(e.state.msg);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.state={trip:null,isLoadingTrip:!0,err:null,messages:null,msg:""},e.tripService=new C,e}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return this.state.isLoadingTrip?r.a.createElement(I,{className:"full-screen-loader"}):r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"db-duo"},r.a.createElement("aside",{className:"db-side"},r.a.createElement($,{tripId:this.state.trip._id})),r.a.createElement("div",{className:"db-lead"},r.a.createElement("div",{className:"card messageboard"},r.a.createElement("div",{className:"card-content"},r.a.createElement("h2",{className:"subtitle"},"Messages"),r.a.createElement("div",{className:"messages"},r.a.createElement("ul",null,this.listOfMessages())),r.a.createElement("form",{onSubmit:this.onSubmitHandler},r.a.createElement("div",{class:"field is-grouped"},r.a.createElement("p",{className:"control is-expanded"},r.a.createElement("input",{className:"input",type:"text",name:"msg",placeholder:"Write a message",value:this.state.msg,onChange:this.onChangeHandler})),r.a.createElement("p",{className:"control"},r.a.createElement("button",{className:"button is-link"},"Submit")))))))))}}]),t}(n.Component),de=function(e){var t=e.component,a=e.user,n=Object(F.a)(e,["component","user"]);return r.a.createElement(f.b,{render:function(e){return a?r.a.createElement(t,Object.assign({},e,{user:a},n)):r.a.createElement(f.a,{to:"/"})}})};function he(e){return r.a.createElement("button",{onClick:e.toggleMenu,className:"button navbar-burger ".concat(e.active?"is-active":"")},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null))}var ve=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).renderTrips=function(){var t=e.props.user.memberships;return t&&t.length>0?t.map((function(t,a){return r.a.createElement("div",{key:a,className:"navbar-item",onClick:function(){return e.selectTrip(t.trip._id)}},t.trip.name)})):r.a.createElement("div",{className:"navbar-item"},r.a.createElement("p",null,"No trips found"))},e.selectTrip=function(){var t=Object(u.a)(o.a.mark((function t(a){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.tripService.setCurrentTrip(a);case 3:n=t.sent,e.props.setUserState(n),e.props.history.push("/trip/".concat(n.currentTrip.trip._id)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}(),e.tripService=new C,e}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return this.props.user.currentTrip?r.a.createElement("div",{className:"navbar-item has-dropdown is-hoverable"},r.a.createElement(i.b,{className:"navbar-link",to:"/profile"},this.props.user.currentTrip.trip.name),r.a.createElement("div",{className:"navbar-dropdown"},this.renderTrips(),r.a.createElement("hr",{className:"navbar-divider"}),r.a.createElement(i.b,{className:"navbar-item",to:"/add-trip"},"Add Trip"))):r.a.createElement("div",{className:"navbar-item has-dropdown is-hoverable"},r.a.createElement(i.b,{className:"navbar-link",to:"/profile"},"Select a trip"),r.a.createElement("div",{className:"navbar-dropdown"},this.renderTrips(),r.a.createElement("hr",{className:"navbar-divider"}),r.a.createElement(i.b,{className:"navbar-item",to:"/add-trip"},"Add Trip")))}}]),t}(n.Component),fe=a(42),be=a.n(fe),Ee=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).toggleMenu=function(){a.setState({activeMenu:!a.state.activeMenu})},a.closeMenu=function(){a.setState({activeMenu:!1})},a.logoutAndCloseMenu=function(){a.props.logout(),a.toggleMenu()},a.state={activeMenu:!1},a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return this.props.user?r.a.createElement("nav",{className:"navbar is-spaced"},r.a.createElement("div",{className:"navbar-brand"},r.a.createElement(i.b,{className:"navbar-item",to:"/dashboard"},r.a.createElement("img",{src:be.a,className:"logo",alt:"logo"})),r.a.createElement(ve,{user:this.props.user,setUserState:this.props.setUserState}),r.a.createElement(he,{active:this.state.activeMenu,toggleMenu:this.toggleMenu})),r.a.createElement("div",{id:"navbarMenu",className:"navbar-menu ".concat(this.state.activeMenu?"is-active":"")},this.props.user.currentTrip&&r.a.createElement("div",{className:"navbar-start"},r.a.createElement(i.b,{className:"navbar-item",to:"/tripmembers/".concat(this.props.user.currentTrip.trip._id),onClick:this.closeMenu},r.a.createElement("span",{className:"icon"},r.a.createElement("i",{className:"far fa-compass"})),r.a.createElement("span",null,"Explore")),r.a.createElement(i.b,{className:"navbar-item",to:"/tripmembers/".concat(this.props.user.currentTrip.trip._id),onClick:this.closeMenu},r.a.createElement("span",{className:"icon"},r.a.createElement("i",{className:"far fa-bookmark"})),r.a.createElement("span",null,"Saved")),r.a.createElement(i.b,{className:"navbar-item",to:"/travelplan/".concat(this.props.user.currentTrip.trip._id),onClick:this.closeMenu},r.a.createElement("span",{className:"icon"},r.a.createElement("i",{className:"fas fa-route"})),r.a.createElement("span",null,"Travel route")),r.a.createElement(i.b,{className:"navbar-item",to:"/messages/".concat(this.props.user.currentTrip.trip._id),onClick:this.closeMenu},r.a.createElement("span",{className:"icon"},r.a.createElement("i",{className:"far fa-comments"})),r.a.createElement("span",null,"Chat"))),r.a.createElement("div",{className:"navbar-end"},r.a.createElement("div",{className:"navbar-item has-dropdown is-hoverable"},r.a.createElement(i.b,{className:"navbar-link",to:"/profile",onClick:this.closeMenu},"My Account"),r.a.createElement("div",{className:"navbar-dropdown"},r.a.createElement("div",{className:"navbar-item account"},r.a.createElement("p",null,r.a.createElement("strong",null,this.props.user.name)),r.a.createElement("p",{className:"small"},this.props.user.email)),r.a.createElement("hr",{className:"navbar-divider"}),r.a.createElement(i.b,{className:"navbar-item",to:"/profile",onClick:this.closeMenu},"Settings"),r.a.createElement(i.b,{className:"navbar-item",onClick:this.logoutAndCloseMenu,to:"/"},"Log out"))),r.a.createElement(i.b,{className:"navbar-item",to:"/notifications",onClick:this.closeMenu},r.a.createElement("span",{className:"icon"},r.a.createElement("i",{className:"fas fa-bell"})))))):r.a.createElement("nav",{className:"navbar is-spaced"},r.a.createElement("div",{className:"navbar-brand"},r.a.createElement(i.b,{className:"navbar-item",to:"/"},r.a.createElement("img",{src:be.a,className:"logo",alt:"logo"})),r.a.createElement(he,{active:this.state.activeMenu,toggleMenu:this.toggleMenu})),r.a.createElement("div",{id:"navbarMenu",className:"navbar-menu ".concat(this.state.activeMenu?"is-active":"")},r.a.createElement("div",{className:"navbar-start"},r.a.createElement(i.b,{className:"navbar-item",to:"/how-it-works",onClick:this.closeMenu},"How it works")),r.a.createElement("div",{className:"navbar-end"},r.a.createElement("div",{className:"navbar-item"},r.a.createElement("div",{className:"buttons"},r.a.createElement(i.b,{className:"button is-primary",to:"/register",onClick:this.closeMenu},r.a.createElement("strong",null,"Sign up")),r.a.createElement(i.b,{className:"button is-light",to:"/login",onClick:this.closeMenu},"Log in"))))))}}]),t}(n.Component),ge=(a(104),function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).componentDidMount=Object(u.a)(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.authService.isLoggedIn();case 3:a=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),a=null;case 9:return t.prev=9,e.setUserState(a),t.finish(9);case 12:case"end":return t.stop()}}),t,null,[[0,6,9,12]])}))),e.setUserState=function(t){e.setState({user:t,isLoadingUser:!1})},e.logout=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.authService.logout();case 3:t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0);case 9:return t.prev=9,e.setState({user:null}),t.finish(9);case 12:case"end":return t.stop()}}),t,null,[[0,6,9,12]])}))),e.state={user:null,isLoadingUser:!0},e.authService=new O,e}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return this.state.isLoadingUser?r.a.createElement(I,{className:"full-screen-loader"}):r.a.createElement("div",{className:"App"},r.a.createElement(Ee,{user:this.state.user,setUserState:this.setUserState,logout:this.logout}),r.a.createElement(f.d,null,r.a.createElement(f.b,{exact:!0,path:"/",component:b}),r.a.createElement(f.b,{path:"/login",render:function(t){return r.a.createElement(k,Object.assign({},t,{setUserState:e.setUserState}))}}),r.a.createElement(f.b,{path:"/register",render:function(t){return r.a.createElement(M,Object.assign({},t,{setUserState:e.setUserState}))}}),r.a.createElement(de,{path:"/dashboard",user:this.state.user,component:L}),r.a.createElement(de,{path:"/profile",user:this.state.user,setUserState:this.setUserState,component:H}),r.a.createElement(de,{path:"/add-trip",user:this.state.user,setUserState:this.setUserState,component:_}),r.a.createElement(f.b,{path:"/trip/:id",user:this.state.user,component:q}),r.a.createElement(f.b,{path:"/travelplan/:id",user:this.state.user,component:X}),r.a.createElement(f.b,{path:"/tripmembers/:id",user:this.state.user,component:te}),r.a.createElement(f.b,{path:"/invite/:task",render:function(t){return r.a.createElement(le,Object.assign({},t,{user:e.state.user,setUserState:e.setUserState}))}}),r.a.createElement(f.b,{path:"/messages/:id",user:this.state.user,component:pe})))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(i.a,null,r.a.createElement(ge,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},42:function(e,t,a){e.exports=a.p+"static/media/tripbuilder.14286e0e.svg"},63:function(e,t,a){e.exports=a(105)},68:function(e,t,a){},69:function(e,t,a){}},[[63,1,2]]]);
//# sourceMappingURL=main.29bcc290.chunk.js.map